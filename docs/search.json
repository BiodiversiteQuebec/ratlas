[{"path":"/articles/database-access-functions.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Functions to directly access the database ressources","text":"ratlas package provides functions interact Biodiversité Québec’s database Atlas. use cases, ratlas get functions get_taxa, get_observations, get_datasets, etc used, designed user-friendly. However, cases, useful directly access database ressources. vignette describes using low-level functions db_read_table db_call_function, ratlas get functions based intended advanced users.","code":""},{"path":"/articles/database-access-functions.html","id":"atlas-database","dir":"Articles","previous_headings":"","what":"Atlas database","title":"Functions to directly access the database ressources","text":"Atlas database PostgreSQL database. contains several tables, views, materialized views, functions, etc. Data stored made available resources. table store data, views materialized views behaves tables used store queries, functions used perform operations data. organized different schema, representing different application layer database. following schemas available: public: Raw biodiversity data stored tables observations, taxa_obs, datasets, variables, efforts, etc. schema relational, joins tables required retrieve data. Data may protected access rights require authentication accessed token (see README). api: schema contains views functions used access data public schema. performs joins tables, returns data user-friendly format. schema used ratlas read/call functions. Data may protected access rights require authentication accessed token (see README). atlas-api: schema contains tables, views functions required operation ‘atlas web portal’. displayed information summary statistics computed resources schema. Data layer protected access rights can accessed without authentication. Documentation tables functions made availabe atlas-db repository documentation.","code":""},{"path":"/articles/database-access-functions.html","id":"reading-tables-and-views-data","dir":"Articles","previous_headings":"","what":"Reading tables and views data","title":"Functions to directly access the database ressources","text":"db_read_table() function used read data PostgreSQL table. takes several arguments, including name table, schema table belongs , authentication token required access database. ’s example use db_read_table() function read data table named “taxa_obs” “public” schema: db_read_table() function returns data.frame object containing data table. data.frame columns named table columns. data.frame row names row numbers table.","code":"library(ratlas) # Added a limit of 100 to simplify the process # Remove the limit argument if you want the whole table data <- db_read_table(\"taxa_obs\", schema = \"public\", limit = 100)"},{"path":"/articles/database-access-functions.html","id":"filtering-data-using-column-values","dir":"Articles","previous_headings":"Reading tables and views data","what":"Filtering data using column values","title":"Functions to directly access the database ressources","text":"db_read_table() function also allows filter data returned specifying additional arguments. example, can use ... argument specify filter condition:","code":"data <- db_read_table(\"taxa_obs\", schema = \"public\", id = 1)  # Or  data <- db_read_table(\"taxa_obs\", schema = \"public\", scientific_name = 'Acer saccharum') head(data) #> # A tibble: 2 × 8 #>       id scientific_name authorship rank    created_at   modified_at modified_by #>    <int> <chr>           <chr>      <chr>   <chr>        <chr>       <chr>       #> 1   7278 Acer saccharum  Marsh.     species 2021-11-23T… 2021-11-23… postgres    #> 2 939205 Acer saccharum  Marshall   species 2024-01-07T… 2024-01-07… vbeaure     #> # ℹ 1 more variable: parent_scientific_name <chr>  # Using a list of values  data <- db_read_table(\"taxa_obs\", schema = \"public\", id = c(1, 2, 3)) head(data) #> # A tibble: 2 × 8 #>      id scientific_name     authorship rank   created_at modified_at modified_by #>   <int> <chr>               <chr>      <chr>  <chr>      <chr>       <chr>       #> 1     1 Prunus pensylvanica L. fil.    speci… 2021-11-1… 2021-11-19… vbeaure     #> 2     2 Sorbus americana    Marsh      speci… 2021-11-1… 2021-11-19… vbeaure     #> # ℹ 1 more variable: parent_scientific_name <lgl>  data <- db_read_table(\"taxa_obs\", schema = \"public\", scientific_name = c('Acer saccharum', 'Acer rubrum')) head(data) #> # A tibble: 4 × 8 #>       id scientific_name authorship rank    created_at   modified_at modified_by #>    <int> <chr>           <chr>      <chr>   <chr>        <chr>       <chr>       #> 1   7279 Acer rubrum     L.         species 2021-11-23T… 2021-11-23… postgres    #> 2 928393 Acer rubrum     L.         species 2024-01-07T… 2024-01-07… vbeaure     #> 3   7278 Acer saccharum  Marsh.     species 2021-11-23T… 2021-11-23… postgres    #> 4 939205 Acer saccharum  Marshall   species 2024-01-07T… 2024-01-07… vbeaure     #> # ℹ 1 more variable: parent_scientific_name <chr>"},{"path":"/articles/database-access-functions.html","id":"selecting-columns-and-limit-the-number-of-rows","dir":"Articles","previous_headings":"Reading tables and views data","what":"Selecting columns and limit the number of rows","title":"Functions to directly access the database ressources","text":"limit select arguments can used limit number rows returned function select specific columns table. arguments useful working large tables, allow limit amount data returned function.","code":"data <- db_read_table(\"taxa_obs\", schema = \"public\", limit = 10)  data <- db_read_table(\"taxa_obs\", schema = \"public\", select = c(\"id\", \"scientific_name\"), limit = 10)"},{"path":"/articles/database-access-functions.html","id":"returning-geometries","dir":"Articles","previous_headings":"Reading tables and views data","what":"Returning geometries","title":"Functions to directly access the database ressources","text":"Many tables database contain geometries. example, observations table contains geom column contains location observation. default, db_read_table() function returns data.frame object geometry column list points. However, can use output_geometry argument return data sf object, made available sf package. sf object preferred format working geometries R.","code":"regions <- db_read_table(\"regions\", schema = \"public\", output_geometry = TRUE, type = 'admin', scale = '2') # Administrative regions of Quebec  data <- db_read_table(\"observations\", schema = \"public\", output_geometry = TRUE, within_quebec = TRUE, limit = 50)  # Plot the regions and the observations plot(regions$geom) plot(data$geom, add = TRUE, col = 'red')"},{"path":"/articles/database-access-functions.html","id":"paginating-results","dir":"Articles","previous_headings":"Reading tables and views data","what":"Paginating results","title":"Functions to directly access the database ressources","text":"default, function paginates results using number 500,000 rows per page, prescribed .page_limit default value. table contains , function automatically download results multiple pages concatenate single data frame. can customize pagination behavior specifying limit offset parameters query. db_read_table() function also provides additional parameters control pagination process, .n_pages .page_limit. ’s example use get_table_data() function download 100 rows table, starting row 200: example, results paginated multiple pages 100 rows .","code":"data <- db_read_table(\"taxa_obs\", schema = \"public\", limit = 100, offset = 200) data <- db_read_table(\"taxa_obs\", schema = \"public\", .page_limit = 100)"},{"path":"/articles/database-access-functions.html","id":"parallelization-of-requests","dir":"Articles","previous_headings":"Reading tables and views data","what":"Parallelization of Requests","title":"Functions to directly access the database ressources","text":"handle downloading data large number rows, function makes requests parallel using multiple cores. db_read_table() function provides optional parameter, .cores, specify number cores use parallel processing. default, function downloads results using parallelization using 4 cores, defined default value .cores. function automatically determine number pages download split work across specified number cores. results combined single data frame. ’s example use db_read_table() function download four pages data parallel using 4 cores:","code":"data <- db_read_table(\"observations\", schema = \"public\", .n_pages = 4, .cores = 4)"},{"path":"/articles/database-access-functions.html","id":"reading-functions-data","dir":"Articles","previous_headings":"","what":"Reading functions data","title":"Functions to directly access the database ressources","text":"db_call_function() function used read data PostgreSQL function. takes several arguments, including name function, schema function belongs , authentication token required access database. Functions arguments can passed function using ... argument. Accepted arguments described function documentation. example, atlas_api.obs_summary function takes following optionnal arguments (taxa_keys, min_year, max_year, region_fid, region_type).","code":"data <- db_call_function(\"obs_summary\", schema = \"atlas_api\") head(data) #> # A tibble: 1 × 13 #>     fid count_datasets obs_count taxa_count taxa_count_carrousel taxa_id_list   #>   <int>          <int>     <int>      <int>                <int> <list>         #> 1     1            826  44583587      27117                41219 <int [41,219]> #> # ℹ 7 more variables: carrousel_info <list>, #> #   taxa_filter_tags.taxa_tags_fr <lgl>, taxa_filter_tags.taxa_tags_en <lgl>, #> #   region_filter_tags.tags_fr <chr>, region_filter_tags.tags_en <chr>, #> #   region_filter_tags.name_fr <chr>, region_filter_tags.name_en <chr>  data <- db_call_function(\"obs_summary\", schema = \"atlas_api\", taxa_keys = c(1, 2, 3), min_year = 2010, max_year = 2015, region_fid = 1, region_type = 'admin') head(data) #> # A tibble: 1 × 13 #>     fid count_datasets obs_count taxa_count taxa_count_carrousel taxa_id_list #>   <int>          <int>     <int>      <int>                <int> <list>       #> 1     1              1         4          1                    1 <int [1]>    #> # ℹ 7 more variables: carrousel_info <list>, #> #   taxa_filter_tags.taxa_tags_fr <list>, taxa_filter_tags.taxa_tags_en <list>, #> #   region_filter_tags.tags_fr <chr>, region_filter_tags.tags_en <chr>, #> #   region_filter_tags.name_fr <chr>, region_filter_tags.name_en <chr>"},{"path":[]},{"path":"/articles/download-obs.html","id":"get-started-quickly-get-canis-lupus-observations-from-atlas","dir":"Articles","previous_headings":"Dowloading observations","what":"Get started quickly : Get Canis Lupus observations from Atlas","title":"Download observations from Atlas","text":"Observations within Atlas may downloaded using get_observations functions. filter request dataset, use function get_taxa() obtain first Canis Lupus taxa data. use filter get observations display first 10 records. RAtlas functions expose Atlas data tables related attributes. observations table returned get_observations function already returns informations related dataset taxonomy observations.","code":"library(ratlas) taxa <- get_taxa(scientific_name = \"Canis lupus\") obs <- get_observations(id_taxa = taxa$id_taxa_obs) head(obs, 10) # Display first record as a vertical list print(t(obs[1, ]))"},{"path":"/articles/download-obs.html","id":"filter-observation-request-using-any-table-attributes","dir":"Articles","previous_headings":"Dowloading observations","what":"Filter observation request using any table attributes","title":"Download observations from Atlas","text":"request may filtered using data attributes used data column Atlas. example, filter original_source column get datasets related Placettes-échantillons permanentes datasets. use id values datasets return observations specified id_datasets taxa associated sugar maple Acer saccharum. Different tables can joined using base pipe |> dplyr functions.","code":"# Get dataset and taxa records for which we will filter observations pep <- get_datasets(original_source = \"Placettes-échantillons permanentes\") |>   dplyr::rename_with(~ paste0(\"ds.\", .x)) taxa <- get_taxa(scientific_name = \"Acer saccharum\") |>   dplyr::rename_with(~ paste0(\"taxa.\", .x))  # Filter observation request through `id_taxa` and `id_datasets` and year values obs <- get_observations(   id_datasets = pep$ds.id,   id_taxa = taxa$taxa.id_taxa_obs,   year = 2018:2021)  print(glue::glue(   \"Found {nrow(obs)} observations between {min(obs$year_obs)} \",   \"and {max(obs$year_obs)}\")   )  # Print map of observations using the package `leaflet`  # install.packages(\"leaflet\") library(leaflet) coord <- head(t(sapply(obs$geometry, as.list)), 100) # Only 100 records shown colnames(coord) <- c(\"lng\", \"lat\")  map <- leaflet() %>%   addTiles() %>%  # Add default OpenStreetMap map tiles   addMarkers(lng = as.numeric(coord[, \"lng\"]), lat = as.numeric(coord[, \"lat\"])) map"},{"path":"/articles/download-regions-observations.html","id":"downloading-observations-by-region","dir":"Articles","previous_headings":"","what":"Downloading observations by region","title":"Download observations by region from Atlas","text":"Regions shown Biodiversité Québec atlas portal can accessed ratlas package used filter downloaded observations. Regions organized type (ie. Ecological Region, Administrative Region, Hexagonal Grid) region type organized scale. recommended explore regions using Biodiversité Québec Atlas web application determine region type scale interest. exercices want return Municipalities Quebec. Specifically, extract observations city Sherbrooke 2002.","code":"library(ratlas) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following object is masked from 'package:ratlas': #>  #>     db_write_table #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union"},{"path":"/articles/download-regions-observations.html","id":"list-regions-available-in-the-atlas-portal","dir":"Articles","previous_headings":"Downloading observations by region","what":"List regions available in the atlas portal","title":"Download observations by region from Atlas","text":"get_regions() function returns data frame regions available atlas portal. function returns data frame following columns: fid: unique identifier region type: type region. Can one cadre_eco, admin, hex scale: integer scale region. Example : 1 province Quebec, 2 administrative regions, 3 MRC, 4 Municipalities name: name region. Example : “Quebec”, “Montreal”, “Laurentides” scale_desc: description scale. Running function without parameters return regions atlas. can large dataset may take long time download. explore regions, recommended use id parameter return specific region type parameter return specific type region. also possible exclude geometry results setting geometry parameter FALSE. Let’s filter results return Municipalities Quebec. search results city Sherbrooke.","code":"regions_desc <- get_regions(geometry = FALSE) head(regions_desc, 20) |> kable() municipalities_desc <- get_regions(type = \"admin\", scale = 4, geometry = FALSE) sherbrooke <- municipalities_desc |> filter(name == \"Sherbrooke\") sherbrooke |> kable()"},{"path":"/articles/download-regions-observations.html","id":"count-observations-for-a-region","dir":"Articles","previous_headings":"Downloading observations by region","what":"Count observations for a region","title":"Download observations by region from Atlas","text":"database obs_regions_taxa_datasets_counts view contains number observations region, taxa datasets. can query directly db_read_table() function.","code":"sherbrooke_count_response <- db_read_table(   table_name = \"obs_regions_taxa_datasets_counts\",   schema = \"atlas_api\",   fid = sherbrooke$fid   # id_taxa_obs = 735,   )  # Total number of observations for the city of Sherbrooke can be summed sherbrooke_count <- sum(sherbrooke_count_response$count_obs) print (paste(\"Number of observations in Sherbrooke:\", sherbrooke_count)) #> [1] \"Number of observations in Sherbrooke: 426867\""},{"path":"/articles/download-regions-observations.html","id":"download-observations-for-a-region","dir":"Articles","previous_headings":"Downloading observations by region","what":"Download observations for a region","title":"Download observations by region from Atlas","text":"can now use fid value city Sherbrooke download observations year 2002. get_observations() function returns data frame observations specified region. filter parameters can used filter results. example, can filter results return observations specific year.","code":"sherbrooke_observations <- get_observations(region_fid = sherbrooke$fid, year = 2002)  # Print number of observations print (paste(\"Number of observations in Sherbrooke in 2002:\", nrow(sherbrooke_observations))) #> [1] \"Number of observations in Sherbrooke in 2002: 4557\""},{"path":[]},{"path":"/articles/post-dataset.html","id":"writing-the-eml","dir":"Articles","previous_headings":"Writing EML metadata and inserting a new dataset to Atlas","what":"Writing the EML","title":"Write and insert dataset metadata to Atlas","text":"EML package provides certain functions help writing certain fields, others need defined manually. first step declare required available fields hand. vignette uses subset possible EML elements tags; complete list, refer EML schema documentation.","code":""},{"path":"/articles/post-dataset.html","id":"required-fields","dir":"Articles","previous_headings":"Writing EML metadata and inserting a new dataset to Atlas > Writing the EML","what":"Required fields","title":"Write and insert dataset metadata to Atlas","text":"","code":"# Title of the dataset title <- \"Test dataset\"  # Creator(s) of the dataset - at least one is required creator <- list(   EML::set_responsibleParty(     givenName = \"John\",     surName = \"Doe\",     organizationName = \"Biodiversité Québec\",     electronicMailAddress = \"test@test.com\"   ),   EML::set_responsibleParty(     givenName = \"Jane\",     surName = \"Doe\",     organizationName = \"Biodiversité Québec\",     electronicMailAddress = \"test@test.com\"   ) )  # Contact(s) of the dataset - at least one is required contact <- EML::set_responsibleParty(   givenName = \"John\",   surName = \"Doe\",   organizationName = \"Biodiversité Québec\",   electronicMailAddress = \"test@test.com\" )"},{"path":"/articles/post-dataset.html","id":"optional-fields","dir":"Articles","previous_headings":"Writing EML metadata and inserting a new dataset to Atlas > Writing the EML","what":"Optional fields","title":"Write and insert dataset metadata to Atlas","text":"","code":"# Publication date of the dataset pub_date <- \"2025-09-16\"  # Abstract of the dataset abstract <- \"This is a test dataset for demonstration purposes.\"  # Keywords associated to the dataset keyword_set <- list(keyword = c(\"biodiversity\", \"ecology\"))  # Urls related to information and download of the dataset distribution <- list(   list(     online = list(       url = list(         `function` = \"information\",         \"https://test.com/info\"       )     )   ),   list(     online = list(       url = list(         `function` = \"download\",         \"https://test.com/download\"       )     )   ) )  # Alternate identifiers for the dataset # DOI is provided here  (without the prefix of https://doi.org/) alternate_identifier <- list(\"10.12309/asdqsd\", \"413\")  # License information licensed <- list(   licenseName = \"Creative Commons Attribution 4.0 International\",   identifier = \"CC-BY-4.0\",   url = \"http//:creativecommons.org/licenses/by/4.0/legalcode\" )  # Associated parties of the dataset associated_party <- list(   individualName = list(     givenName = \"Cookie\",     surName = \"Doe\"   ),   organizationName = \"Culinary school\",   role = \"Cookie provider\" )  # Provider of the metadata for the dataset metadata_provider <- EML::set_responsibleParty(   givenName = \"Johnny\",   surName = \"Bravo\",   organizationName = \"Mirror Inc.\",   electronicMailAddress = \"test@test.com\" )  # Any additional information about the dataset additional_info <- list(markdown = EML::set_TextType(text = \"Some more important information.\"))  # Language used in the dataset language <- \"English\"  # Publisher of the dataset publisher <- list(   organizationName = \"Biodiversité Québec\" )  # Coverage (taxonomic, temporal and geographic) of the dataset geographic_description <- \"Sherbrooke, Qc, Canada\" coverage <- EML::set_coverage(   begin = \"2025-09-01\", end = \"2025-09-24\",   sci_names = \"Homo sapiens sapiens\",   geographicDescription = geographic_description,   west = -122.44, east = -117.15,   north = 37.38, south = 30.00,   altitudeMin = 160, altitudeMaximum = 330,   altitudeUnits = \"meter\" )  # Citation, provided in additionalMetadata additional_metadata <- list(   metadata = list(     citation = \"Bravo, J. (2021). How to mirror. Journal of Bg, 48(7), 1552-1563.\"   ) )  # The fields methods is EML compliant, but currently not implemented # Methods used. Either provided as raw jsonb or as a markdown file with EML::set_methods() #EML::set_methods(methods_file = \"/dev_scratch/test.md\")"},{"path":"/articles/post-dataset.html","id":"non-eml-fields","dir":"Articles","previous_headings":"Writing EML metadata and inserting a new dataset to Atlas > Writing the EML","what":"Non-EML fields","title":"Write and insert dataset metadata to Atlas","text":"Others fields non EML compliant still required tracking managment information Atlas.","code":"# Data type (occurrence, time series, etc.) data_type <- \"occurrence\"  # The url of the source EML source_eml_url <- \"https://url-of-the-source-eml.test\"  # Source alias (custom alias to recognize the dataset in the database) source_alias <- \"TEST\"  # Shareable data (TRUE/FALSE) shareable_data <- FALSE"},{"path":"/articles/post-dataset.html","id":"validate-and-insert-the-dataset-to-atlas","dir":"Articles","previous_headings":"Writing EML metadata and inserting a new dataset to Atlas","what":"Validate and insert the dataset to Atlas","title":"Write and insert dataset metadata to Atlas","text":"required optional fields defined, can send post_dataset function create, validate insert dataset Atlas. Since function exported, needs used triple colon operator: ratlas:::post_dataset(). function return UUID newly created dataset.","code":"dataset_uuid <- ratlas:::post_dataset(   title = title,   creator = creator,   contact = contact,   pub_date = pub_date,   abstract = abstract,   keyword_set = keyword_set,   distribution = distribution,   alternate_identifier = alternate_identifier,   licensed = licensed,   associated_party = associated_party,   metadata_provider = metadata_provider,   additional_info = additional_info,   language = language,   publisher = publisher,   coverage = coverage,   methods = methods,   additional_metadata = additional_metadata,   data_type = data_type,   source_eml_url = source_eml_url,   source_alias = source_alias,   shareable_data = shareable_data )"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Vincent Beauregard. Author, maintainer. Benjamin Mercier. Author, contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Beauregard V, Mercier B (2025). ratlas: R Package Access Analysis Data Aggregated Biodiversité Québec. R package version 2.1.","code":"@Manual{,   title = {ratlas: R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec},   author = {Vincent Beauregard and Benjamin Mercier},   year = {2025},   note = {R package version 2.1}, }"},{"path":"/index.html","id":"documentation-du-paquet-ratlas","dir":"","previous_headings":"","what":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"ratlas est un paquet R permettant l’accès et l’analyse des données de biodiversité aggrégée par le réseau d’observation de la biodiversité du Québec. Ce paquet R expose les services RESTFull de l’API de Atlas. Atlas est un système d’information sur la biodiversité du Québec développé par Biodiversité Québec et le laboratoire d’Écologie Intégrative de l’Université de Sherbrooke. L’Atlas est depuis tout récemment disponible via un geoparquet (documentation geoparquet). Pour une expérience optimale et plus rapide, nous recommandons d’interagir avec Atlas via ce geoparquet. Toutefois, si vous désirez tout de même utiliser le package ratlas, nous vous recommandons de débuter par la lecture de l’article tutoriel pour le téléchargement d’observations.","code":""},{"path":"/index.html","id":"installer-le-paquet-ratlas","dir":"","previous_headings":"","what":"Installer le paquet ratlas","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"","code":"devtools::install_github(\"ReseauBiodiversiteQuebec/ratlas\")"},{"path":"/index.html","id":"sauthentifier-auprès-de-lapi","dir":"","previous_headings":"","what":"S’authentifier auprès de l’API","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"Un jeton d’accès vous sera mis à disposition par l’équipe de développeur de Atlas. Veuillez les contacter pour en obtenir un de manière sécurisée. Il est fortement recommandé de mettre en cache votre jeton d’accès (jeton d’accès stocké dans un fichier rds) afin de s’assurer qu’il ne soit pas visible ou transmis avec votre code à un autre utilisateur. Ce jeton d’accès est unique et révocable. Pour cela, il vous suffit simplement d’enregistrer le jeton d’accès directement en tant que Environment variable.","code":""},{"path":"/index.html","id":"stratégie-1-mise-en-cache-dans-les-variables-denvironnement-de-r","dir":"","previous_headings":"S’authentifier auprès de l’API","what":"Stratégie 1: Mise en cache dans les variables d’environnement de R","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"Cette ligne va ouvrir un ficher text dans votre Rstudio. Rajoutez dans ce ficher un linge comme la suivante: Le jeton d’accès est un exemple ici et n’est aucunement valide.","code":"file.edit(\"~/.Renviron\") # utilizez votre propre token ici  ATLAS_API_TOKEN=7f8df438e1be96a18436e9dab5d97d68ed0e0441d9b68f59e0ce631b2919f3aa"},{"path":"/index.html","id":"stratégie-2-environnement-au-niveau-os--runtime","dir":"","previous_headings":"S’authentifier auprès de l’API","what":"Stratégie 2: Environnement au niveau OS / runtime","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"Vous pouvez également passer votre jeton d’accès en créant une variable d’environnement nommée ATLAS_API_TOKEN au niveau de l’OS ou de l’environnement de dévelopement.","code":""},{"path":[]},{"path":"/index.html","id":"erreur-401--unauthorized","dir":"","previous_headings":"Troubleshooting","what":"Erreur 401 : Unauthorized","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"Si vous obtenez une erreur 401, c’est que votre jeton d’accès n’est pas valide. Veuillez vous assurer que vous avez bien copié le jeton d’accès et que vous l’avez bien mis en cache dans votre environnement de développement. Pour valider que votre jeton d’accès est bien en cache, vous pouvez utiliser la fonction Sys.getenv(\"ATLAS_API_TOKEN\") qui devrait retourner votre jeton d’accès.","code":""},{"path":"/index.html","id":"erreur-curl_fetch_memory-0a00010bssl","dir":"","previous_headings":"Troubleshooting","what":"Erreur curl_fetch_memory 0A00010B:SSL","title":"R Package For Access and Analysis Of Data Aggregated By Biodiversité Québec","text":"Erreur possible lors de la récupération (GET) de données via une machine Linux (ici Ubuntu). L’erreur provient du package curl. Un correctif est disponible depuis la version 7.87.0 du package qui elle est disponible depuis la version 23.02 de Ubuntu.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Vincent Beauregard Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/reference/dataset_insert.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","text":"function designed interface web API deployed PostgREST Function exported, meant internal use . can called like : ratlas:::post_dataset()","code":""},{"path":"/reference/dataset_insert.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","text":"","code":"dataset_insert(   title,   creator,   pub_date = NULL,   abstract = NULL,   keyword_set = NULL,   distribution = NULL,   alternate_identifier = NULL,   licensed = NULL,   associated_party = NULL,   contact,   metadata_provider = NULL,   additional_info = NULL,   language = NULL,   publisher = NULL,   coverage = NULL,   methods = NULL,   additional_metadata = NULL,   data_type,   source_eml_url = NULL,   source_alias,   shareable_data = FALSE,   schema = \"api\" )"},{"path":"/reference/dataset_insert.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","text":"title character. Name dataset. creator list. List responsibleParty objects created EML::set_responsibleParty(). pub_date Optional. character. Publication date dataset \"YYYY-MM-DD\" format. abstract Optional. character. Abstract dataset. keyword_set Optional. list. List keywordSet objects created manually. distribution Optional. list. List list distribution objects created manually. alternate_identifier Optional. list. List alternateIdentifier character. DOI declared . licensed Optional. list. List license informations created manually. associated_party Optional. list. List responsibleParty objects created manually. contact list. List responsibleParty objects created EML::set_responsibleParty(). metadata_provider Optional. list. List responsibleParty objects created EML::set_responsibleParty(). additional_info Optional. list. List additional information dataset created EML::set_TextType() markdown tag. language Optional. character. Language dataset. publisher Optional. list. List responsibleParty objects created EML::set_responsibleParty(). coverage Optional. list. List coverage objects created EML::set_coverage(). methods Optional. jsonb. Methods section created EML::set_methods() manually. additional_metadata Optional. character. Citation string, nested metadata, citation. Non-EML parameters: data_type character. Type data, example: occurrence, time series, etc. source_eml_url Optional. character. URL source EML. source_alias character. Internal alias recognize dataset. shareable_data boolean. Default FALSE, TRUE means license share data. schema obligatory api, function resides schema backend.","code":""},{"path":"/reference/dataset_insert.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","text":"newly generated dataset UUID.","code":""},{"path":"/reference/dataset_insert.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — dataset_insert","text":"EML parameters:","code":""},{"path":"/reference/db_call_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic function to access data from functions in Atlas database — db_call_function","title":"Generic function to access data from functions in Atlas database — db_call_function","text":"Return data objects stored obtained endpoints corresponding name database function.","code":""},{"path":"/reference/db_call_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic function to access data from functions in Atlas database — db_call_function","text":"","code":"db_call_function(   name,   schema = \"public\",   output_geometry = FALSE,   output_flatten = TRUE,   .token = NULL,   ... )"},{"path":"/reference/db_call_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic function to access data from functions in Atlas database — db_call_function","text":"name character. Name atlas function accessed. data. Can either api, public atlas_api. schema Optional. character Schema database located data. Can either api, public atlas_api. output_geometry Optional. logical default FALSE. TRUE, returns sf object using geometry column function output. output_flatten Optional. logical default FALSE. TRUE, returns data.frame object nested objects flattened. .token Optional. character Bearer token providing access web api. ... character numeric scalar vector. Arguments passed function.","code":""},{"path":"/reference/db_call_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic function to access data from functions in Atlas database — db_call_function","text":"tibble rows associated Atlas data object","code":""},{"path":"/reference/db_call_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic function to access data from functions in Atlas database — db_call_function","text":"function designed interface web API deployed PostgREST","code":""},{"path":"/reference/db_read_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic function to access data from tables and views in Atlas database — db_read_table","title":"Generic function to access data from tables and views in Atlas database — db_read_table","text":"Return data objects stored tables views Atlas database.","code":""},{"path":"/reference/db_read_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic function to access data from tables and views in Atlas database — db_read_table","text":"","code":"db_read_table(   table_name,   schema = \"public\",   output_geometry = FALSE,   output_flatten = TRUE,   limit = NULL,   select = NULL,   ...,   .cores = 4,   .n_pages = NULL,   .page_limit = 10000 )"},{"path":"/reference/db_read_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic function to access data from tables and views in Atlas database — db_read_table","text":"table_name character. Name table accessed. schema character default 'public'. Schema database table located. Can either public, api, public_api, atlas_api. output_geometry Optional. logical default FALSE. TRUE, returns sf object using geometry column table. output_flatten logical default TRUE. TRUE, returns data.frame object nested objects flattened. limit Optional. integer default NULL. Maximum number rows return. NULL, rows returned. PostgREST API syntax. select Optional. character default NULL. List columns return. columns returned NULL. PostgREST API syntax. ... Additional parameters passed query API table_name. .cores Optional. integer default 4. Number cores use parallel processing. 1, parallel processing used. NULL, function automatically determine number cores use based number available cores system. .n_pages Optional. integer default NULL. Number pages download. ' NULL, number pages estimated number rows table. .page_limit Optional. integer default 500000. Maximum number rows download per page. parameter used estimate number pages download .n_pages NULL.","code":""},{"path":"/reference/db_read_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic function to access data from tables and views in Atlas database — db_read_table","text":"tibble sf rows associated Atlas data object","code":""},{"path":"/reference/db_read_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic function to access data from tables and views in Atlas database — db_read_table","text":"function designed interface web API deployed PostgREST.","code":""},{"path":"/reference/db_write_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic function to post data into Atlas databases — db_write_table","title":"Generic function to post data into Atlas databases — db_write_table","text":"Data records attributes (list names columns) must corresponds table columns sent . (ie. taxa, observations, datasets, etc).","code":""},{"path":"/reference/db_write_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic function to post data into Atlas databases — db_write_table","text":"","code":"db_write_table(   table_name,   data,   ...,   schema = \"public\",   host = ATLAS_API_V4_HOST(),   .page_limit = 50000,   .token = ATLAS_API_TOKEN(),   .cores = 4 )"},{"path":"/reference/db_write_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic function to post data into Atlas databases — db_write_table","text":"table_name character. Name atlas data object destination. Corresponds name within Atlas Postgresql database, stored within schema public ou api data list data.frame. Either single record list names attributes multiple records data.frame attributes columns attibutes corresponding destination column tables. ... character numeric scalar vector. Additional parameters provide request. May correspond postgrest http request parameters syntax. schema character Schema database located data object located. Accept either values api public (default) .page_limit integer Count objects returned pagination .token character Bearer token providing access web api .cores integer default 4. Number cores used parallelize improve rapidity","code":""},{"path":"/reference/db_write_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic function to post data into Atlas databases — db_write_table","text":"function designed interface web API deployed PostgREST","code":""},{"path":"/reference/get_datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"Get datasets — get_datasets","title":"Get datasets — get_datasets","text":"function downloads returns list dataframe containing description requested dataset row corresponds record. function returns dataframe datasets parameters specified. function filters returned datasets record attributes corresponding atlas table columns specified parameters (ie. id, title, original_source, etc) accepted values either scalar vector single multiple records","code":""},{"path":"/reference/get_datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get datasets — get_datasets","text":"","code":"get_datasets(id = NULL, ...)"},{"path":"/reference/get_datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get datasets — get_datasets","text":"id Optional. integer scalar vector. Returns dataframe dataset specified id ... Optional. scalar vector. Returns dataframe filtered atlas datasets table columns specified parameter","code":""},{"path":"/reference/get_datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get datasets — get_datasets","text":"tibble rows associated Atlas data object","code":""},{"path":"/reference/get_datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get datasets — get_datasets","text":"","code":"# Returns all available datasets records in atlas datasets <- get_datasets()  # Returns all datasets filtered by the column `original_source` datasets <- get_datasets(original_source = \"eBird\")  # Returns all datasets filtered by the column id corresponding to eBird datasets <- get_datasets(id = 55:102)"},{"path":"/reference/get_observations.html","id":null,"dir":"Reference","previous_headings":"","what":"Get observations — get_observations","title":"Get observations — get_observations","text":"function downloads returns list dataframe containing observations single record per row. function returns dataframe containing records parameters specified (STRONGLY DISCOURAGED DUE LARGE AMOUNT OBSERVATIONS CONTAINED WITHIN ATLAS). function filters returned records attributes corresponding atlas table columns specified parameters (ie. id, year_obs, id_taxa, id_datasets, id_variables, fid_region, etc) accepted values either scalar vector single multiple records.","code":""},{"path":"/reference/get_observations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get observations — get_observations","text":"","code":"get_observations(   id = NULL,   year = NULL,   id_taxa = NULL,   region_fid = NULL,   geometry = TRUE,   within_quebec = NULL,   ... )"},{"path":"/reference/get_observations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get observations — get_observations","text":"id Optional. integer scalar vector. Returns dataframe observation specified id year Optional. integer scalar vector. Returns dataframe observations related id_taxa id_taxa Optional. integer scalar vector. Returns dataframe taxa_obs record related value. id_taxa translated id_taxa_obs within_quebec Optional. logical default NULL. TRUE, returns observations within Quebec. FALSE, returns observations outside Quebec. NULL, returns observations. ... Optional. scalar vector. Returns dataframe filtered atlas observations table columns specified parameter (ie. id_datasets, id_variables, month_obs, day_obs) fid_region Optional. integer scalar vector. Returns observations region specified id .cores Optional. integer default 4. Number cores used parallelize improve rapidity","code":""},{"path":"/reference/get_observations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get observations — get_observations","text":"tibble rows associated Atlas observations","code":""},{"path":"/reference/get_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get regions — get_regions","title":"Get regions — get_regions","text":"function downloads returns list dataframe containing geometries attributes requested region row corresponds region. Regions organized type (ie. Ecological Region, Administrative Region, Hexagonal Grfid) region type organized scale. recommended explore regions using Biodiversité Québec Atlas web application determine region type scale interest.","code":""},{"path":"/reference/get_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get regions — get_regions","text":"","code":"get_regions(fid = NULL, type = NULL, scale = NULL, geometry = TRUE, ...)"},{"path":"/reference/get_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get regions — get_regions","text":"type Optional. character scalar vector. Returns dataframe filtered atlas regions table column type specified parameter. Accepted values cadre_eco, admin, hex ... Optional. scalar vector. Returns dataframe filtered atlas regions table columns specified parameter. fid_region Optional. integer scalar vector. Returns dataframe region specified fid zoom Optional. integer scalar vector. Returns dataframe","code":""},{"path":"/reference/get_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get regions — get_regions","text":"IMPORTANT : Running function without parameters return regions atlas. can large dataset may take long time download. recommended use fid parameter return specific region type parameter return specific type region. also possible exclude geometry results setting geometry parameter FALSE.","code":""},{"path":"/reference/get_taxa.html","id":null,"dir":"Reference","previous_headings":"","what":"Get taxa — get_taxa","title":"Get taxa — get_taxa","text":"function downloads returns list dataframe containing taxonomic description requested species row corresponds individual species. function returns dataframe species parameters specified. function filters returned taxa record attributes corresponding atlas table columns specified parameters (ie. id, scientific_name, col, gbif, etc) accepted values either scalar vector single multiple records","code":""},{"path":"/reference/get_taxa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get taxa — get_taxa","text":"","code":"get_taxa(id = NULL, scientific_name = NULL, match_name = NULL, ...)"},{"path":"/reference/get_taxa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get taxa — get_taxa","text":"id Optional. integer scalar vector. Returns dataframe taxon specified id scientific_name Optional. char scalar vector. Returns dataframe taxon specified scientific name match_name Optional. char scalar vector. Returns dataframe taxon specified scientific name vernacular name. Vernacular names french english accepted. ... Optional. scalar vector. Returns dataframe filtered atlas taxa table columns specified parameter","code":""},{"path":"/reference/get_taxa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get taxa — get_taxa","text":"tibble rows associated Atlas data object","code":""},{"path":"/reference/get_taxa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get taxa — get_taxa","text":"","code":"# Returns all available taxa records in atlas taxa <- get_taxa()  # Returns all taxa filtered by the column id values taxa <- get_taxa(id = c(188, 201, 294, 392))  # Returns taxa record for the scientific name taxa <- get_taxa(scientific_name = \"Cyanocitta cristata\")  # Return taxa filtered by the atlas table column `col` results <- get_taxa(col = 35520954)"},{"path":"/reference/post_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","text":"function designed interface web API deployed PostgREST Function exported, meant internal use . can called like : ratlas:::post_dataset()","code":""},{"path":"/reference/post_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","text":"","code":"post_dataset(   title,   creator,   pub_date = NULL,   abstract = NULL,   keyword_set = NULL,   distribution = NULL,   alternate_identifier = NULL,   licensed = NULL,   associated_party = NULL,   contact,   metadata_provider = NULL,   additional_info = NULL,   language = NULL,   publisher = NULL,   coverage = NULL,   methods = NULL,   additional_metadata = NULL,   data_type,   source_eml_url = NULL,   source_alias,   shareable_data = FALSE,   schema = \"api\" )"},{"path":"/reference/post_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","text":"title character. Name dataset. creator list. List responsibleParty objects created EML::set_responsibleParty(). pub_date Optional. character. Publication date dataset \"YYYY-MM-DD\" format. abstract Optional. character. Abstract dataset. keyword_set Optional. list. List keywordSet objects created manually. distribution Optional. list. List list distribution objects created manually. alternate_identifier Optional. list. List alternateIdentifier character. DOI declared . licensed Optional. list. List license informations created manually. associated_party Optional. list. List responsibleParty objects created manually. contact list. List responsibleParty objects created EML::set_responsibleParty(). metadata_provider Optional. list. List responsibleParty objects created EML::set_responsibleParty(). additional_info Optional. list. List additional information dataset created EML::set_TextType() markdown tag. language Optional. character. Language dataset. publisher Optional. list. List responsibleParty objects created EML::set_responsibleParty(). coverage Optional. list. List coverage objects created EML::set_coverage(). methods Optional. jsonb. Methods section created EML::set_methods() manually. additional_metadata Optional. character. Citation string, nested metadata, citation. Non-EML parameters: data_type character. Type data, example: occurrence, time series, etc. source_eml_url Optional. character. URL source EML. source_alias character. Internal alias recognize dataset. shareable_data boolean. Default FALSE, TRUE means license share data. schema obligatory api, function resides schema backend.","code":""},{"path":"/reference/post_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","text":"newly generated dataset UUID.","code":""},{"path":"/reference/post_dataset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to insert datasets in Atlas. Formatting should follow https://eml.ecoinformatics.org/schema/ — post_dataset","text":"EML parameters:","code":""}]
