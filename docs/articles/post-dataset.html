<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Write and insert dataset metadata to Atlas • ratlas</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write and insert dataset metadata to Atlas">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratlas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/database-access-functions.html">Functions to directly access the database ressources</a></li>
    <li><a class="dropdown-item" href="../articles/download-obs.html">Download observations from Atlas</a></li>
    <li><a class="dropdown-item" href="../articles/download-regions-observations.html">Download observations by region from Atlas</a></li>
    <li><a class="dropdown-item" href="../articles/post-dataset.html">Write and insert dataset metadata to Atlas</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write and insert dataset metadata to Atlas</h1>
            
      

      <div class="d-none name"><code>post-dataset.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="writing-eml-metadata-and-inserting-a-new-dataset-to-atlas">Writing EML metadata and inserting a new dataset to Atlas<a class="anchor" aria-label="anchor" href="#writing-eml-metadata-and-inserting-a-new-dataset-to-atlas"></a>
</h2>
<div class="section level3">
<h3 id="writing-the-eml">Writing the EML<a class="anchor" aria-label="anchor" href="#writing-the-eml"></a>
</h3>
<p>While the <code>EML</code> package provides certain functions to help
writing certain fields, others need to be defined manually. The first
step is to declare all the required and available fields at hand. This
vignette only uses a subset of all the possible EML elements and tags;
for a complete list, refer to the <a href="https://eml.ecoinformatics.org/schema/" class="external-link">EML schema
documentation</a>.</p>
<div class="section level4">
<h4 id="required-fields">Required fields<a class="anchor" aria-label="anchor" href="#required-fields"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Title of the dataset</span></span>
<span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Test dataset"</span></span>
<span></span>
<span><span class="co"># Creator(s) of the dataset - at least one is required</span></span>
<span><span class="va">creator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_responsibleParty.html" class="external-link">set_responsibleParty</a></span><span class="op">(</span></span>
<span>    givenName <span class="op">=</span> <span class="st">"John"</span>,</span>
<span>    surName <span class="op">=</span> <span class="st">"Doe"</span>,</span>
<span>    organizationName <span class="op">=</span> <span class="st">"Biodiversité Québec"</span>,</span>
<span>    electronicMailAddress <span class="op">=</span> <span class="st">"test@test.com"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_responsibleParty.html" class="external-link">set_responsibleParty</a></span><span class="op">(</span></span>
<span>    givenName <span class="op">=</span> <span class="st">"Jane"</span>,</span>
<span>    surName <span class="op">=</span> <span class="st">"Doe"</span>,</span>
<span>    organizationName <span class="op">=</span> <span class="st">"Biodiversité Québec"</span>,</span>
<span>    electronicMailAddress <span class="op">=</span> <span class="st">"test@test.com"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Contact(s) of the dataset - at least one is required</span></span>
<span><span class="va">contact</span> <span class="op">&lt;-</span> <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_responsibleParty.html" class="external-link">set_responsibleParty</a></span><span class="op">(</span></span>
<span>  givenName <span class="op">=</span> <span class="st">"John"</span>,</span>
<span>  surName <span class="op">=</span> <span class="st">"Doe"</span>,</span>
<span>  organizationName <span class="op">=</span> <span class="st">"Biodiversité Québec"</span>,</span>
<span>  electronicMailAddress <span class="op">=</span> <span class="st">"test@test.com"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional-fields">Optional fields<a class="anchor" aria-label="anchor" href="#optional-fields"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Publication date of the dataset</span></span>
<span><span class="va">pub_date</span> <span class="op">&lt;-</span> <span class="st">"2025-09-16"</span></span>
<span></span>
<span><span class="co"># Abstract of the dataset</span></span>
<span><span class="va">abstract</span> <span class="op">&lt;-</span> <span class="st">"This is a test dataset for demonstration purposes."</span></span>
<span></span>
<span><span class="co"># Keywords associated to the dataset</span></span>
<span><span class="va">keyword_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>keyword <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biodiversity"</span>, <span class="st">"ecology"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Urls related to information and download of the dataset</span></span>
<span><span class="va">distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    online <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        `function` <span class="op">=</span> <span class="st">"information"</span>,</span>
<span>        <span class="st">"https://test.com/info"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    online <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        `function` <span class="op">=</span> <span class="st">"download"</span>,</span>
<span>        <span class="st">"https://test.com/download"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternate identifiers for the dataset</span></span>
<span><span class="co"># DOI is provided here  (without the prefix of https://doi.org/)</span></span>
<span><span class="va">alternate_identifier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"10.12309/asdqsd"</span>, <span class="st">"413"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># License information</span></span>
<span><span class="va">licensed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  licenseName <span class="op">=</span> <span class="st">"Creative Commons Attribution 4.0 International"</span>,</span>
<span>  identifier <span class="op">=</span> <span class="st">"CC-BY-4.0"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"http//:creativecommons.org/licenses/by/4.0/legalcode"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Associated parties of the dataset</span></span>
<span><span class="va">associated_party</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  individualName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    givenName <span class="op">=</span> <span class="st">"Cookie"</span>,</span>
<span>    surName <span class="op">=</span> <span class="st">"Doe"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  organizationName <span class="op">=</span> <span class="st">"Culinary school"</span>,</span>
<span>  role <span class="op">=</span> <span class="st">"Cookie provider"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Provider of the metadata for the dataset</span></span>
<span><span class="va">metadata_provider</span> <span class="op">&lt;-</span> <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_responsibleParty.html" class="external-link">set_responsibleParty</a></span><span class="op">(</span></span>
<span>  givenName <span class="op">=</span> <span class="st">"Johnny"</span>,</span>
<span>  surName <span class="op">=</span> <span class="st">"Bravo"</span>,</span>
<span>  organizationName <span class="op">=</span> <span class="st">"Mirror Inc."</span>,</span>
<span>  electronicMailAddress <span class="op">=</span> <span class="st">"test@test.com"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Any additional information about the dataset</span></span>
<span><span class="va">additional_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>markdown <span class="op">=</span> <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_TextType.html" class="external-link">set_TextType</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Some more important information."</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Language used in the dataset</span></span>
<span><span class="va">language</span> <span class="op">&lt;-</span> <span class="st">"English"</span></span>
<span></span>
<span><span class="co"># Publisher of the dataset</span></span>
<span><span class="va">publisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  organizationName <span class="op">=</span> <span class="st">"Biodiversité Québec"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coverage (taxonomic, temporal and geographic) of the dataset</span></span>
<span><span class="va">geographic_description</span> <span class="op">&lt;-</span> <span class="st">"Sherbrooke, Qc, Canada"</span></span>
<span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_coverage.html" class="external-link">set_coverage</a></span><span class="op">(</span></span>
<span>  begin <span class="op">=</span> <span class="st">"2025-09-01"</span>, end <span class="op">=</span> <span class="st">"2025-09-24"</span>,</span>
<span>  sci_names <span class="op">=</span> <span class="st">"Homo sapiens sapiens"</span>,</span>
<span>  geographicDescription <span class="op">=</span> <span class="va">geographic_description</span>,</span>
<span>  west <span class="op">=</span> <span class="op">-</span><span class="fl">122.44</span>, east <span class="op">=</span> <span class="op">-</span><span class="fl">117.15</span>,</span>
<span>  north <span class="op">=</span> <span class="fl">37.38</span>, south <span class="op">=</span> <span class="fl">30.00</span>,</span>
<span>  altitudeMin <span class="op">=</span> <span class="fl">160</span>, altitudeMaximum <span class="op">=</span> <span class="fl">330</span>,</span>
<span>  altitudeUnits <span class="op">=</span> <span class="st">"meter"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Citation, provided in additionalMetadata</span></span>
<span><span class="va">additional_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    citation <span class="op">=</span> <span class="st">"Bravo, J. (2021). How to mirror. Journal of Bg, 48(7), 1552-1563."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The fields methods is EML compliant, but currently not implemented</span></span>
<span><span class="co"># Methods used. Either provided as raw jsonb or as a markdown file with EML::set_methods()</span></span>
<span><span class="co">#EML::set_methods(methods_file = "/dev_scratch/test.md")</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="non-eml-fields">Non-EML fields<a class="anchor" aria-label="anchor" href="#non-eml-fields"></a>
</h4>
<p>Others fields that are non EML compliant are still required for
tracking and managment of the information in Atlas.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data type (occurrence, time series, etc.)</span></span>
<span><span class="va">data_type</span> <span class="op">&lt;-</span> <span class="st">"occurrence"</span></span>
<span></span>
<span><span class="co"># The url of the source EML</span></span>
<span><span class="va">source_eml_url</span> <span class="op">&lt;-</span> <span class="st">"https://url-of-the-source-eml.test"</span></span>
<span></span>
<span><span class="co"># Source alias (custom alias to recognize the dataset in the database)</span></span>
<span><span class="va">source_alias</span> <span class="op">&lt;-</span> <span class="st">"TEST"</span></span>
<span></span>
<span><span class="co"># Shareable data (TRUE/FALSE)</span></span>
<span><span class="va">shareable_data</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="validate-and-insert-the-dataset-to-atlas">Validate and insert the dataset to Atlas<a class="anchor" aria-label="anchor" href="#validate-and-insert-the-dataset-to-atlas"></a>
</h3>
<p>Once all the required and optional fields are defined, we can send it
to the <code>post_dataset</code> function which will create, validate
and insert the dataset to Atlas. Since this function is not exported, it
needs to be used with the triple colon operator:
<code>ratlas:::post_dataset()</code>. The function will return the UUID
of the newly created dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_uuid</span> <span class="op">&lt;-</span> <span class="fu">ratlas</span><span class="fu">:::</span><span class="fu"><a href="../reference/post_dataset.html">post_dataset</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="va">title</span>,</span>
<span>  creator <span class="op">=</span> <span class="va">creator</span>,</span>
<span>  contact <span class="op">=</span> <span class="va">contact</span>,</span>
<span>  pub_date <span class="op">=</span> <span class="va">pub_date</span>,</span>
<span>  abstract <span class="op">=</span> <span class="va">abstract</span>,</span>
<span>  keyword_set <span class="op">=</span> <span class="va">keyword_set</span>,</span>
<span>  distribution <span class="op">=</span> <span class="va">distribution</span>,</span>
<span>  alternate_identifier <span class="op">=</span> <span class="va">alternate_identifier</span>,</span>
<span>  licensed <span class="op">=</span> <span class="va">licensed</span>,</span>
<span>  associated_party <span class="op">=</span> <span class="va">associated_party</span>,</span>
<span>  metadata_provider <span class="op">=</span> <span class="va">metadata_provider</span>,</span>
<span>  additional_info <span class="op">=</span> <span class="va">additional_info</span>,</span>
<span>  language <span class="op">=</span> <span class="va">language</span>,</span>
<span>  publisher <span class="op">=</span> <span class="va">publisher</span>,</span>
<span>  coverage <span class="op">=</span> <span class="va">coverage</span>,</span>
<span>  methods <span class="op">=</span> <span class="va">methods</span>,</span>
<span>  additional_metadata <span class="op">=</span> <span class="va">additional_metadata</span>,</span>
<span>  data_type <span class="op">=</span> <span class="va">data_type</span>,</span>
<span>  source_eml_url <span class="op">=</span> <span class="va">source_eml_url</span>,</span>
<span>  source_alias <span class="op">=</span> <span class="va">source_alias</span>,</span>
<span>  shareable_data <span class="op">=</span> <span class="va">shareable_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent Beauregard, Benjamin Mercier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
